# StrengthWise - å°ˆæ¡ˆé–‹ç™¼èƒŒæ™¯èˆ‡è¦ç¯„

> **çµ¦ Cursor çš„å¤§è…¦**ï¼šé€™æ˜¯å°ˆæ¡ˆçš„å…¨è²Œèˆ‡æ ¸å¿ƒè¦å‰‡ï¼Œè«‹åœ¨é–‹å§‹ä»»ä½•ä»»å‹™å‰å…ˆé–±è®€æ­¤æ–‡ä»¶ã€‚

---

## 1. å°ˆæ¡ˆç°¡ä»‹

é€™æ˜¯ä¸€å€‹ä½¿ç”¨ Flutter é–‹ç™¼çš„å¥èº«ç´€éŒ„ Appï¼Œç›®å‰æ­£åœ¨è½‰å‹ç‚ºã€Œæ•™ç·´èˆ‡å­¸å“¡çš„é›™é‚Šå¹³å°ã€ã€‚

**ç›®æ¨™**ï¼šè®“æ•™ç·´å¯ä»¥ç®¡ç†å­¸å“¡ã€å®‰æ’èª²ç¨‹ã€ç´€éŒ„ä¸Šèª²ç­†è¨˜ï¼Œå­¸å“¡å‰‡å¯ä»¥æŸ¥çœ‹èª²è¡¨èˆ‡é ç´„ã€‚

---

## 2. æŠ€è¡“æ£§ (Tech Stack)

- **Frontend**: Flutter (Dart SDK >=3.1.0, Flutter >=3.16.0)
- **Backend**: Firebase (Firestore, Auth, Storage, Analytics, Crashlytics, Messaging)
- **State Management**: Provider (ChangeNotifier)
- **ä¾è³´æ³¨å…¥**: GetIt (Service Locator Pattern)
- **æœ¬åœ°å„²å­˜**: Hiveã€SharedPreferences
- **Architecture**: MVVM + Clean Architecture

---

## 3. ç¾æœ‰è³‡æ–™åº«ç‹€æ³ (Current DB Analysis)

æ ¹æ“šå¯¦éš› Firestore è³‡æ–™åº«åˆ†æï¼ˆ`docs/02_FIRESTORE_ANALYSIS.md`ï¼‰ï¼Œè³‡æ–™åº«å­˜åœ¨å†—é¤˜èˆ‡çµæ§‹ä¸ä¸€è‡´ï¼š

### ç”¨æˆ¶é›†åˆé‡è¤‡ âš ï¸
- **`user` é›†åˆ**ï¼šåŒ…å« `isTrainee`, `isTrainer`, `bio`, `lastLogin`ï¼ˆèˆŠçµæ§‹ï¼Œéœ€é·ç§»ï¼‰
- **`users` é›†åˆ**ï¼šåŒ…å« `isCoach`, `isStudent`, `height`, `age`ï¼ˆæ–°çµæ§‹ï¼Œç›®æ¨™é›†åˆï¼‰

### å…¶ä»–é›†åˆ
- **`notes` é›†åˆ**ï¼šç›®å‰å­˜å„²ç¹ªåœ–è»Œè·¡ (`drawingPoints`)ï¼Œä½†ç¼ºä¹èˆ‡ç‰¹å®šèª²ç¨‹çš„é—œè¯ï¼ˆç¼ºå°‘ `appointmentId`, `studentId`ï¼‰
- **`workoutPlans`**ï¼šå­˜å„²èª²è¡¨å…§å®¹ï¼ŒåŒ…å« `creatorId`, `traineeId`, `exercises` ç­‰
- **`exercise`, `bodyParts`, `exerciseTypes`**ï¼šéœæ…‹è³‡æ–™ï¼Œä¿æŒä¸è®Š
- **`bookings`, `relationships`, `availabilities`**ï¼šè¨ˆåŠƒåŠŸèƒ½ï¼Œç›®å‰ç‚ºç©ºé›†åˆ

---

## 4. é–‹ç™¼æº–å‰‡ (Rules for AI)

### ğŸš¨ å¿…é ˆéµå®ˆ

1. **ä¸è¦ç ´å£ç¾æœ‰åŠŸèƒ½**ï¼šä¿®æ”¹ä»£ç¢¼æ™‚ï¼Œç¢ºä¿å€‹äººçš„å¥èº«ç´€éŒ„åŠŸèƒ½ä¸å—å½±éŸ¿ã€‚
2. **å‹åˆ¥å®‰å…¨**ï¼šæ‰€æœ‰ Firestore çš„æ“ä½œéƒ½å¿…é ˆé€é Model Class (`.fromMap`, `.toMap`) é€²è¡Œï¼Œåš´ç¦ç›´æ¥æ“ä½œ `Map<String, dynamic>`ã€‚
3. **è¨»è§£è¦ç¯„**ï¼šé—œéµé‚è¼¯è«‹åŠ ä¸Š**ç¹é«”ä¸­æ–‡è¨»è§£**ï¼Œå…¬å…±æ–¹æ³•ä½¿ç”¨ Dart Doc è¨»è§£ï¼ˆ`///`ï¼‰ã€‚
4. **å°æ­¥æäº¤**ï¼šæ¯å€‹ä»»å‹™å®Œæˆå¾Œï¼Œè«‹ç¢ºä¿ App å¯ä»¥ç·¨è­¯é€šéã€‚
5. **ä¾è³´æ³¨å…¥**ï¼šæ‰€æœ‰æœå‹™é€šé `serviceLocator` ç²å–ï¼Œæ§åˆ¶å™¨é€šéæ§‹é€ å‡½æ•¸æ³¨å…¥ä¾è³´ã€‚
6. **éŒ¯èª¤è™•ç†**ï¼šçµ±ä¸€ä½¿ç”¨ `ErrorHandlingService` è¨˜éŒ„éŒ¯èª¤ï¼Œæ§åˆ¶å™¨å±¤æ•ç²ç•°å¸¸ä¸¦è½‰æ›ç‚ºç”¨æˆ¶å‹å¥½çš„éŒ¯èª¤è¨Šæ¯ã€‚

### ğŸ“ ä»£ç¢¼ç¯„ä¾‹

```dart
// âœ… æ­£ç¢ºï¼šä½¿ç”¨ Model é¡åˆ¥
final user = UserModel.fromMap(doc.data()!);
await firestore.collection('users').doc(uid).set(user.toMap());

// âŒ éŒ¯èª¤ï¼šç›´æ¥æ“ä½œ Map
await firestore.collection('users').doc(uid).set({'name': 'John'});
```

```dart
// âœ… æ­£ç¢ºï¼šä½¿ç”¨ serviceLocator
final workoutController = serviceLocator<IWorkoutController>();

// âœ… æ­£ç¢ºï¼šç¹é«”ä¸­æ–‡è¨»è§£
/// è¼‰å…¥ç”¨æˆ¶çš„è¨“ç·´æ¨¡æ¿
/// è¿”å›ç”¨æˆ¶å‰µå»ºçš„æ‰€æœ‰è¨“ç·´è¨ˆåŠƒ
Future<List<WorkoutTemplate>> loadUserTemplates() async {
  // æª¢æŸ¥ç·©å­˜æ˜¯å¦éœ€è¦æ›´æ–°
  // ...
}
```

---

## 5. å°ˆæ¡ˆçµæ§‹

```
lib/
â”œâ”€â”€ models/          # è³‡æ–™æ¨¡å‹å±¤
â”œâ”€â”€ services/        # æœå‹™å±¤ï¼ˆè³‡æ–™è¨ªå•ï¼‰
â”‚   â””â”€â”€ interfaces/  # æœå‹™ä»‹é¢å®šç¾©
â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨å±¤ï¼ˆæ¥­å‹™é‚è¼¯ï¼‰
â”‚   â””â”€â”€ interfaces/  # æ§åˆ¶å™¨ä»‹é¢å®šç¾©
â””â”€â”€ views/          # UI å±¤
    â””â”€â”€ pages/      # å„åŠŸèƒ½é é¢
```

---

## 6. ä»»å‹™åŸ·è¡Œé †åº

è«‹æŒ‰ç…§ä»¥ä¸‹é †åºåŸ·è¡Œä»»å‹™ï¼š

1. **00_PROJECT_CONTEXT.md**ï¼ˆæœ¬æ–‡ä»¶ï¼‰- ç†è§£å°ˆæ¡ˆå…¨è²Œ
2. **01_TASK_DB_REFACTOR.md** - ä½¿ç”¨è€…è³‡æ–™åº«é‡æ§‹ï¼ˆæœ€é‡è¦ï¼‰
3. **02_TASK_RELATIONSHIPS.md** - æ•™ç·´å­¸å“¡ç¶å®šåŠŸèƒ½
4. **03_TASK_BOOKING.md** - é ç´„ç³»çµ±æ ¸å¿ƒ
5. **04_TASK_TEACHING.md** - æ•™å­¸ç­†è¨˜æ•´åˆ

---

## 7. ç›¸é—œæ–‡æª”

- `AGENTS.md` - å®Œæ•´é–‹ç™¼æŒ‡å—
- `.cursorrules` - æ ¸å¿ƒé–‹ç™¼è¦ç¯„
- `docs/02_FIRESTORE_ANALYSIS.md` - å¯¦éš›è³‡æ–™åº«åˆ†æå ±å‘Š
- `docs/01_TASK_DB_REFACTOR.md` - è³‡æ–™åº«é‡æ§‹ä»»å‹™è©³æƒ…

---

**é‡è¦æé†’**ï¼šæ‰€æœ‰ä»£ç¢¼è¨»è§£ã€è®Šæ•¸å‘½åã€ç”¨æˆ¶ä»‹é¢æ–‡å­—éƒ½å¿…é ˆä½¿ç”¨**ç¹é«”ä¸­æ–‡**ã€‚


